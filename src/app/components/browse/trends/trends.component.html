<div class="space-y-3 md:space-y-8 animate-fade-in pb-20 md:pb-28" appInfiniteScroll (scrolled)="loadMore()">
    <!-- SEO-optimized header with semantic HTML -->
    <header class="mb-3 md:mb-8">
        <h1
            class="text-xl md:text-3xl lg:text-4xl font-bold bg-gradient-to-r from-emerald-400 to-cyan-500 bg-clip-text text-transparent">
            Tendencias Musicales Globales
        </h1>
        <p class="text-zinc-400 mt-1 md:mt-2 text-xs md:text-base">
            Descubre lo m치s escuchado del momento. M칰sica sin l칤mites. 游꿧
        </p>
    </header>

    <!-- Region Filters - Compact on mobile -->
    <div class="flex gap-2 mb-3 md:mb-6">
        <button *ngFor="let region of regions" (click)="changeRegion(region.code)"
            [class.active]="selectedRegion() === region.code"
            class="px-3 py-1.5 md:px-6 md:py-2.5 rounded-lg md:rounded-xl font-medium text-xs md:text-base transition-all duration-300 flex items-center gap-1.5 md:gap-2"
            [ngClass]="{
                    'bg-emerald-500 text-white shadow-lg shadow-emerald-500/30': selectedRegion() === region.code,
                    'bg-zinc-800/50 text-zinc-400 hover:bg-zinc-800 hover:text-zinc-300': selectedRegion() !== region.code
                }">
            <span class="text-base md:text-xl">{{region.flag}}</span>
            <span>{{region.name}}</span>
        </button>
    </div>

    <!-- Loading state -->
    <div *ngIf="loading()" class="flex justify-center py-8 md:py-12" role="status" aria-label="Cargando tendencias">
        <div class="animate-spin rounded-full h-8 w-8 md:h-12 md:w-12 border-t-2 border-b-2 border-emerald-500">
        </div>
    </div>

    <!-- Top 1-5 Songs (Visual only - no click action) -->
    <section aria-label="Top 5 canciones" *ngIf="!loading()">
        <div class="grid gap-1.5 md:gap-4">
            <article *ngFor="let song of trendingSongs().slice(0, 5); let i = index" (click)="onSongClick(song, $event)"
                class="flex items-center gap-2 md:gap-4 p-2 md:p-4 rounded-lg md:rounded-xl bg-zinc-900/50 hover:bg-zinc-800/70 transition-all duration-300 group border border-transparent hover:border-emerald-500/20"
                [attr.aria-label]="'Posici칩n ' + (i + 1) + ': ' + song.title + ' por ' + song.artist">

                <!-- Rank number -->
                <span
                    class="text-lg md:text-2xl lg:text-3xl font-bold text-zinc-700 w-6 md:w-10 text-center group-hover:text-emerald-500 transition-colors flex-shrink-0"
                    aria-hidden="true">
                    {{i + 1}}
                </span>

                <!-- Album cover with error handling -->
                <div
                    class="w-10 h-10 md:w-14 md:h-14 lg:w-16 lg:h-16 bg-zinc-800 rounded-md md:rounded-lg flex-shrink-0 shadow-lg overflow-hidden ring-2 ring-transparent group-hover:ring-emerald-500/30 transition-all duration-300">
                    <img [src]="song.img" [alt]="'Portada de ' + song.album + ' por ' + song.artist"
                        (error)="onImageError($event)" loading="lazy"
                        class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-300">
                </div>

                <!-- Song info -->
                <div class="flex-1 min-w-0">
                    <h2
                        class="font-bold text-xs md:text-base lg:text-lg truncate group-hover:text-emerald-400 transition-colors">
                        {{song.title}}
                    </h2>
                    <p
                        class="text-[10px] md:text-sm lg:text-base text-zinc-500 truncate group-hover:text-zinc-400 transition-colors">
                        {{song.artist}}
                    </p>
                </div>

                <!-- Trending badge -->
                <div class="text-emerald-500 text-[10px] md:text-sm font-medium px-1.5 py-0.5 md:px-3 md:py-1.5 bg-emerald-500/10 rounded-full flex items-center gap-0.5 md:gap-1 flex-shrink-0"
                    aria-label="Tendencia">
                    <i class='bx bx-trending-up text-sm md:text-lg' aria-hidden="true"></i>
                    <span class="hidden md:inline">Top</span>
                </div>
            </article>
        </div>
    </section>

    <!-- Ad Banner after Top 5 -->
    <!-- <app-ad-banner adType="Banner Principal" class="my-4 md:my-8 block" aria-label="Publicidad"></app-ad-banner> -->

    <!-- Remaining Songs (6+) with Infinite Scroll -->
    <section aria-label="M치s tendencias" *ngIf="trendingSongs().length > 5">
        <div class="grid gap-1.5 md:gap-3">
            <article *ngFor="let song of trendingSongs().slice(5); let i = index" (click)="onSongClick(song, $event)"
                class="flex items-center gap-2 md:gap-4 p-1.5 md:p-3 rounded-lg md:rounded-xl bg-zinc-900/50 hover:bg-zinc-800/70 transition-all duration-300 group border border-transparent hover:border-zinc-700"
                [attr.aria-label]="'Posici칩n ' + (i + 6) + ': ' + song.title + ' por ' + song.artist">

                <!-- Rank number -->
                <span
                    class="text-sm md:text-lg lg:text-xl font-bold text-zinc-700 w-5 md:w-8 text-center group-hover:text-emerald-500 transition-colors flex-shrink-0"
                    aria-hidden="true">
                    {{i + 6}}
                </span>

                <!-- Album cover with error handling -->
                <div
                    class="w-9 h-9 md:w-12 md:h-12 lg:w-14 lg:h-14 bg-zinc-800 rounded-md md:rounded-lg flex-shrink-0 overflow-hidden ring-2 ring-transparent group-hover:ring-emerald-500/20 transition-all duration-300">
                    <img [src]="song.img" [alt]="'Portada de ' + song.album + ' por ' + song.artist"
                        (error)="onImageError($event)" loading="lazy"
                        class="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-300">
                </div>

                <!-- Song info -->
                <div class="flex-1 min-w-0">
                    <h3
                        class="font-medium text-xs md:text-sm lg:text-base truncate group-hover:text-zinc-300 transition-colors">
                        {{song.title}}
                    </h3>
                    <p
                        class="text-[10px] md:text-sm text-zinc-500 truncate group-hover:text-zinc-400 transition-colors">
                        {{song.artist}}
                    </p>
                </div>

                <!-- Duration (desktop only) -->
                <span
                    class="hidden lg:block text-xs text-zinc-600 group-hover:text-zinc-400 transition-colors flex-shrink-0">
                    {{song.duration}}
                </span>
            </article>
        </div>
    </section>

    <!-- Loading More Indicator -->
    <div *ngIf="loadingMore()" class="flex justify-center py-4 md:py-8" role="status"
        aria-label="Cargando m치s canciones">
        <div class="flex items-center gap-2 md:gap-3 text-emerald-400">
            <div class="animate-spin rounded-full h-5 w-5 md:h-6 md:w-6 border-t-2 border-b-2 border-emerald-500"></div>
            <span class="text-xs md:text-sm font-medium">Cargando m치s...</span>
        </div>
    </div>

    <!-- End of List Message -->
    <div *ngIf="!hasMore && !loading() && trendingSongs().length > 0" class="text-center py-4 md:py-8">
        <p class="text-zinc-500 text-xs md:text-base">
            Has llegado al final de las tendencias 游꿧
        </p>
        <p class="text-zinc-600 text-[10px] md:text-xs mt-1 md:mt-2">
            춰Vuelve pronto para m치s m칰sica!
        </p>
    </div>

    <!-- Bottom Ad Banner -->
    <!-- <app-ad-banner adType="Banner Principal" class="my-4 md:my-8 block" aria-label="Publicidad"></app-ad-banner> -->
</div>